
window.addEventListener("load",myMain,false);var $port;function myMain(a){$port=chrome.runtime.connect(editorExtensionId);$port.onMessage.addListener(processMessage)}function processMessage(a){if(a==="next"){goNext()}else{if(a==="prev"){goPrev()}else{if(a==="ext"){$port.postMessage({type:"ext",contents:extractContents()})}else{if(a==="loc"){$port.postMessage({type:"loc",contents:extractLoc()})}}}}}function extractContents(){var a=new Array();$("div#kindleReader_content").find("iframe").each(function(){var c=$(this)[0].style.visibility;var b=parseFloat($(this)[0].style.height);if(c==="visible"){$(this).contents().find(".k4w").each(function(){if($(this).offset().top>=0&&$(this).offset().top<=(b-$(this)[0].offsetHeight)){a.push($(this).text())}})}});return a}function extractLoc(){return $("#kindleReader_immersiveFooter").text()}function goNext(){$(".kindleReader_arrowBtn")[1].click()}function goPrev(){$(".kindleReader_arrowBtn")[0].click()};